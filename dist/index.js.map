{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap 69f62a137e718396843c","webpack:///./src/MobxPromise.ts","webpack:///./src/utils.ts","webpack:///external \"mobx\"","webpack:///./src/index.ts"],"names":[],"mappings":"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","file":"index.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"mobx\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([\"mobx\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"index\"] = factory(require(\"mobx\"));\n\telse\n\t\troot[\"index\"] = factory(root[\"mobx\"]);\n})(this, function(__WEBPACK_EXTERNAL_MODULE_2__) {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmony imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 3);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 69f62a137e718396843c","import {observable, action, extras} from \"mobx\";\nimport {cached} from \"./utils\";\n\n/**\n * This tagged union type describes the interoperability of MobxPromise properties.\n */\nexport type MobxPromiseUnionType<R> = (\n\t{ status: 'pending', isPending: true, isError: false, isComplete: false, result: undefined, error: undefined } |\n\t{ status: 'error', isPending: false, isError: true, isComplete: false, result: undefined, error: Error } |\n\t{ status: 'complete', isPending: false, isError: false, isComplete: true, result: R, error: undefined }\n);\nexport type MobxPromiseUnionTypeWithDefault<R> = (\n\t{ status: 'pending', isPending: true, isError: false, isComplete: false, result: R, error: undefined } |\n\t{ status: 'error', isPending: false, isError: true, isComplete: false, result: R, error: Error } |\n\t{ status: 'complete', isPending: false, isError: false, isComplete: true, result: R, error: undefined }\n);\n\nexport type MobxPromiseInputUnion<R> = PromiseLike<R> | (() => PromiseLike<R>) | MobxPromiseInputParams<R>;\nexport type MobxPromiseInputParams<R> = {\n\t/**\n\t * A function that returns a list of MobxPromise objects which are dependencies of the invoke function.\n\t */\n\tawait?: MobxPromise_await,\n\n\t/**\n\t * A function that returns the async result or a promise for the async result.\n\t */\n\tinvoke: MobxPromise_invoke<R>,\n\n\t/**\n\t * Default result in place of undefined\n\t */\n\tdefault?: R,\n\n\t/**\n\t * A function that will be called when the latest promise from invoke() is resolved.\n\t * It will not be called for out-of-date promises.\n\t */\n\treaction?: (result?:R) => void,\n};\nexport type MobxPromise_await = () => Array<MobxPromiseUnionTypeWithDefault<any> | MobxPromiseUnionType<any> | MobxPromise<any>>;\nexport type MobxPromise_invoke<R> = () => PromiseLike<R>;\nexport type MobxPromiseInputParamsWithDefault<R> = {\n\tawait?: MobxPromise_await,\n\tinvoke: MobxPromise_invoke<R>,\n\tdefault: R,\n\treaction?: (result:R) => void,\n};\n\n/**\n * MobxPromise provides an observable interface for a computed promise.\n * @author adufilie http://github.com/adufilie\n */\nexport class MobxPromiseImpl<R>\n{\n\tstatic isPromiseLike(value?:Partial<PromiseLike<any>>)\n\t{\n\t\treturn value != null && typeof value === 'object' && typeof value.then === 'function';\n\t}\n\n\tstatic normalizeInput<R>(input:MobxPromiseInputParamsWithDefault<R>):MobxPromiseInputParamsWithDefault<R>\n\tstatic normalizeInput<R>(input:MobxPromiseInputUnion<R>, defaultResult:R):MobxPromiseInputParamsWithDefault<R>\n\tstatic normalizeInput<R>(input:MobxPromiseInputUnion<R>, defaultResult?:R)\n\t{\n\t\tif (typeof input === 'function')\n\t\t\treturn {invoke: input, default: defaultResult};\n\n\t\tif (MobxPromiseImpl.isPromiseLike(input))\n\t\t\treturn {invoke: () => input as PromiseLike<R>, default: defaultResult};\n\n\t\tinput = input as MobxPromiseInputParams<R>;\n\t\tif (defaultResult !== undefined)\n\t\t\tinput = {...input, default: defaultResult};\n\t\treturn input;\n\t}\n\n\tconstructor(input:MobxPromiseInputUnion<R>, defaultResult?:R)\n\t{\n\t\tinput = MobxPromiseImpl.normalizeInput(input, defaultResult);\n\t\tthis.await = input.await;\n\t\tthis.invoke = input.invoke;\n\t\tthis.defaultResult = input.default;\n\t\tthis.reaction = input.reaction;\n\t}\n\n\tprivate await?:MobxPromise_await;\n\tprivate invoke:MobxPromise_invoke<R>;\n\tprivate reaction?:(result?:R) => void;\n\tprivate defaultResult?:R;\n\tprivate invokeId:number = 0;\n\tprivate _latestInvokeId:number = 0;\n\n\t@observable private internalStatus:'pending'|'complete'|'error' = 'pending';\n\t@observable.ref private internalResult?:R = undefined;\n\t@observable.ref private internalError?:Error = undefined;\n\n\t@cached get status():'pending'|'complete'|'error'\n\t{\n\t\t// wait until all MobxPromise dependencies are complete\n\t\tif (this.await)\n\t\t\tfor (let mobxPromise of this.await())\n\t\t\t\tif (!mobxPromise.isComplete)\n\t\t\t\t\treturn mobxPromise.status;\n\n\t\tlet status = this.internalStatus; // force mobx to track changes to internalStatus\n\t\tif (this.latestInvokeId != this.invokeId)\n\t\t\tstatus = 'pending';\n\t\treturn status;\n\t}\n\n\t@cached get isPending() { return this.status == 'pending'; }\n\t@cached get isComplete() { return this.status == 'complete'; }\n\t@cached get isError() { return this.status == 'error'; }\n\n\t@cached get result():R|undefined\n\t{\n\t\t// checking status may trigger invoke\n\t\tif (this.isError || this.internalResult == null)\n\t\t\treturn this.defaultResult;\n\n\t\treturn this.internalResult;\n\t}\n\n\t@cached get error():Error|undefined\n\t{\n\t\t// checking status may trigger invoke\n\t\tif (this.isError && this.await)\n\t\t\tfor (let mobxPromise of this.await())\n\t\t\t\tif (mobxPromise.isError)\n\t\t\t\t\treturn mobxPromise.error;\n\n\t\treturn this.internalError;\n\t}\n\n\t/**\n\t * This lets mobx determine when to call this.invoke(),\n\t * taking advantage of caching based on observable property access tracking.\n\t */\n\t@cached private get latestInvokeId()\n\t{\n\t\twindow.clearTimeout(this._latestInvokeId);\n\t\tlet promise = this.invoke();\n\t\tlet invokeId:number = window.setTimeout(() => this.setPending(invokeId, promise));\n\t\treturn this._latestInvokeId = invokeId;\n\t}\n\n\t@action private setPending(invokeId:number, promise:PromiseLike<R>)\n\t{\n\t\tthis.invokeId = invokeId;\n\t\tpromise.then(\n\t\t\tresult => this.setComplete(invokeId, result),\n\t\t\terror => this.setError(invokeId, error)\n\t\t);\n\t\tthis.internalStatus = 'pending';\n\t}\n\n\t@action private setComplete(invokeId:number, result:R)\n\t{\n\t\tif (invokeId === this.invokeId)\n\t\t{\n\t\t\tthis.internalResult = result;\n\t\t\tthis.internalStatus = 'complete';\n\n\t\t\tif (this.reaction)\n\t\t\t\tthis.reaction(this.result);\n\t\t}\n\t}\n\n\t@action private setError(invokeId:number, error:Error)\n\t{\n\t\tif (invokeId === this.invokeId)\n\t\t{\n\t\t\tthis.internalError = error;\n\t\t\tthis.internalStatus = 'error';\n\t\t}\n\t}\n}\n\nexport type MobxPromiseFactory = {\n\t// This provides more information for TypeScript code flow analysis\n\t<R>(input:MobxPromiseInputParamsWithDefault<R>):MobxPromiseUnionTypeWithDefault<R>;\n\t<R>(input:MobxPromiseInputUnion<R>, defaultResult: R):MobxPromiseUnionTypeWithDefault<R>;\n\t<R>(input:MobxPromiseInputUnion<R>):MobxPromiseUnionType<R>;\n};\n\nexport const MobxPromise = MobxPromiseImpl as {\n\t// This provides more information for TypeScript code flow analysis\n\tnew <R>(input:MobxPromiseInputParamsWithDefault<R>): MobxPromiseUnionTypeWithDefault<R>;\n\tnew <R>(input:MobxPromiseInputUnion<R>, defaultResult: R): MobxPromiseUnionTypeWithDefault<R>;\n\tnew <R>(input:MobxPromiseInputUnion<R>): MobxPromiseUnionType<R>;\n};\n\nexport interface MobxPromise<T> extends Pick<MobxPromiseImpl<T>, 'status' | 'error' | 'result' | 'isPending' | 'isError' | 'isComplete'>\n{\n}\n\nexport default MobxPromise;\n\n\n\n// WEBPACK FOOTER //\n// ./src/MobxPromise.ts","import {computed, extras, IComputedValue} from 'mobx';\r\nimport {MobxPromise, MobxPromiseInputUnion, MobxPromiseImpl, MobxPromiseFactory} from \"./MobxPromise\";\r\n\r\n/**\r\n * A decorator for creating a <code>@computed</code> property that will be cached\r\n * after the first time it is accessed, even if it becomes unobserved later.\r\n * @param target\r\n * @param propertyKey\r\n * @param descriptor\r\n */\r\nexport function cached<T>(target: any, propertyKey: string | symbol, descriptor: TypedPropertyDescriptor<T>)\r\n{\r\n\tif (descriptor.get)\r\n\t{\r\n\t\tlet firstTime = true;\r\n\t\tlet get = descriptor.get;\r\n\t\tdescriptor.get = function(...args:any[]) {\r\n\t\t\tif (firstTime)\r\n\t\t\t{\r\n\t\t\t\tconst computed = extras.getAtom(this, propertyKey as string) as any as IComputedValue<any>;\r\n\t\t\t\tcomputed.observe(function() { /*noop*/ });\r\n\t\t\t\tfirstTime = false;\r\n\t\t\t}\r\n\t\t\treturn get.apply(this, args);\r\n\t\t};\r\n\t}\r\n\treturn computed(target, propertyKey, descriptor);\r\n}\r\n\r\n/**\r\n * Update MobxPromise debug names to reflect their property names on a given object.\r\n * @param target An object which has properties that are MobxPromises.\r\n */\r\nexport function labelMobxPromises<T extends object>(target:T)\r\n{\r\n\tfor (let key in target)\r\n\t{\r\n\t\tlet desc = Object.getOwnPropertyDescriptor(target, key);\r\n\t\tif (desc && desc.value instanceof MobxPromise)\r\n\t\t{\r\n\t\t\tlet admin = extras.getAdministration(desc.value);\r\n\t\t\tadmin.name = `${key}(${admin.name})`;\r\n\t\t}\r\n\t}\r\n}\r\n\r\n/**\r\n * Creates a function which constructs a MobxPromise that will pass the result and default values through a given function.\r\n * For example, this can be used to make results immutable.\r\n * @param resultModifier\r\n * @returns {(input:MobxPromiseInputUnion<R>, defaultResult?:R)=>MobxPromiseUnionType<R>}\r\n */\r\nexport function createMobxPromiseFactory(resultModifier: <R>(result:R) => R):MobxPromiseFactory\r\n{\r\n\treturn function<R>(input:MobxPromiseInputUnion<R>, defaultResult?: R) {\r\n\t\tinput = MobxPromiseImpl.normalizeInput(input, defaultResult);\r\n\t\tconst invoke = input.invoke;\r\n\t\tinput.invoke = () => invoke().then(resultModifier);\r\n\t\tinput.default = resultModifier(input.default);\r\n\t\treturn new MobxPromise(input);\r\n\t};\r\n}\r\n\r\n/**\r\n * A function created with debounceAsync() returns a new Promise\r\n * every time, but only the last promise created before invoking the\r\n * original function will be resolved after a specified delay.\r\n */\r\nexport function debounceAsync<R, F extends (...args:any[]) => PromiseLike<R>>(invoke:F, delay = 0):F\r\n{\r\n\tfunction invokeLater(\r\n\t\tcontext:any,\r\n\t\targs:any[],\r\n\t\tresolve:(result:PromiseLike<R>)=>void,\r\n\t\treject:(error:Error)=>void\r\n\t) {\r\n\t\ttry\r\n\t\t{\r\n\t\t\tresolve(invoke.apply(context, args));\r\n\t\t}\r\n\t\tcatch (e)\r\n\t\t{\r\n\t\t\treject(e);\r\n\t\t}\r\n\t}\r\n\r\n\tlet timeout = 0;\r\n\treturn function(...args:any[]):PromiseLike<R> {\r\n\t\treturn new Promise<R>(\r\n\t\t\tfunction(resolve, reject) {\r\n\t\t\t\twindow.clearTimeout(timeout);\r\n\t\t\t\ttimeout = window.setTimeout(invokeLater, delay, this, args, resolve, reject);\r\n\t\t\t}\r\n\t\t);\r\n\t} as F;\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/utils.ts","module.exports = __WEBPACK_EXTERNAL_MODULE_2__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"mobx\"\n// module id = 2\n// module chunks = 0","export * from './MobxPromise';\r\nexport * from './utils';\r\n\r\nimport MobxPromise from './MobxPromise';\r\nexport default MobxPromise;\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/index.ts"],"sourceRoot":""}